<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HTTP Server Middleware Library: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="cypress_logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HTTP Server Middleware Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Overview </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >This library provides the HTTP Server implementation that can work on Infineon MCUs with Wi-Fi connectivity.It supports RESTful methods such as GET, PUT, and POST for the client to communicate with this HTTP Server library.</p>
<h1><a class="anchor" id="section_features"></a>
Features</h1>
<ul>
<li>Supports Wi-Fi and Ethernet connections.</li>
<li>Supports HTTP/1.1 protocol version.</li>
<li>Secure [with TLS security] and non-secure modes of connection.</li>
<li>Supports RESTful HTTP methods: GET, PUT, and POST.</li>
<li>Handles various resource content types such as HTML, Plain, and JSON.</li>
<li>Capable of handling content payload greater than the MTU size using the Content-Length HTTP header. This feature is supported only for <code>CY_RAW_DYNAMIC_URL_CONTENT</code> and <code>CY_DYNAMIC_URL_CONTENT</code> content types</li>
<li>Supports chunked encoding for GET and POST methods. <br  />
 <blockquote class="doxtable">
<p >Note: For a POST request, chunked encoding is supported only for the data that is less than a single MTU; Content-Length headers are recommended for larger data. </p>
</blockquote>
* Supports Server-Sent Events (SSE). SSE is a server push technology, enabling an HTTP client (for example, a browser or any device running an HTTP client) to receive automatic updates from the HTTP server via the HTTP connection.</li>
</ul>
<h1><a class="anchor" id="section_platforms"></a>
Supported Platforms</h1>
<h2><a class="anchor" id="section_plat_anycloud"></a>
ModusToolbox™</h2>
<ul>
<li><a href="https://www.infineon.com/cms/en/product/evaluation-boards/cy8cproto-062-4343w/">PSoC&trade; 6 WiFi-BT Prototyping Kit (CY8CPROTO-062-4343W)</a></li>
<li><a href="https://www.infineon.com/cms/en/product/evaluation-boards/cy8ckit-062s2-43012/">PSoC&trade; 62S2 Wi-Fi BT Pioneer Kit (CY8CKIT-062S2-43012)</a></li>
<li><a href="https://www.infineon.com/cms/en/product/evaluation-boards/cy8ceval-062s2/">PSoC&trade; 62S2 evaluation kit (CY8CEVAL-062S2-LAI-4373M2)</a></li>
<li><a href="https://www.infineon.com/cms/en/product/evaluation-boards/cy8ckit-062-wifi-bt/">PSoC&trade; 6 WiFi-BT Pioneer Kit (CY8CKIT-062-WiFi-BT)</a></li>
<li><a href="https://www.infineon.com/cms/en/product/evaluation-boards/cyw943907aeval1f">CYW943907AEVAL1F evaluation kit (CYW943907AEVAL1F)</a></li>
<li><a href="https://www.infineon.com/cms/en/product/evaluation-boards/cyw954907aeval1f">CYW954907AEVAL1F evaluation kit (CYW954907AEVAL1F)</a></li>
<li><a href="https://www.infineon.com/cms/en/product/evaluation-boards/cy8ceval-062s2/">PSoC&trade; 62S2 evaluation kit (CY8CEVAL-062S2-MUR-43439M2)</a></li>
<li><a href="https://www.infineon.com/cms/en/product/evaluation-boards/kit_xmc72_evk/">XMC7200D-E272K8384 kit (KIT-XMC72-EVK)</a></li>
<li><a href="https://www.infineon.com/cms/en/product/evaluation-boards/kit_xmc72_evk/">XMC7200D-E272K8384 kit (KIT_XMC72_EVK_MUR_43439M2)</a></li>
<li><a href="https://www.infineon.com/cms/en/product/evaluation-boards/cy8ceval-062s2/">PSoC&trade; 62S2 evaluation kit (CY8CEVAL-062S2-CYW43022CUB)</a></li>
<li><a href="https://www.infineon.com/CYW955913EVK-01">CYW955913EVK-01 Wi-Fi Bluetooth&reg; Prototyping Kit (CYW955913EVK-01)</a></li>
</ul>
<h1><a class="anchor" id="section_frameworks"></a>
Supported Frameworks</h1>
<ul>
<li>ModusToolbox&trade; environment: In this environment the HTTP Server Library uses the <a href="https://github.com/Infineon/abstraction-rtos">abstraction-rtos</a> library that provides the RTOS abstraction API and uses the <a href="https://github.com/Infineon/secure-sockets">secure-sockets</a> library for implementing socket functions.</li>
</ul>
<h1><a class="anchor" id="section_quick_start"></a>
Quick Start</h1>
<p >This library is supported on ModusToolbox&trade; framework and below section provides information on how to build this library in ModusToolbox&trade; framework.</p>
<h2><a class="anchor" id="framework_1"></a>
ModusToolbox™</h2>
<ul>
<li>To use http-server library with Wi-Fi kits on FreeRTOS, lwIP, and Mbed TLS combination, the application should pull <a href="https://github.com/Infineon/http-server">http-server</a> library and <a href="https://github.com/Infineon/wifi-core-freertos-lwip-mbedtls">wifi-core-freertos-lwip-mbedtls</a> library which will internally pull secure-sockets, wifi-connection-manager, FreeRTOS, lwIP, Mbed TLS and other dependent modules. To pull wifi-core-freertos-lwip-mbedtls and http-server libraries create the following *.mtb* files in deps folder.<ul>
<li>wifi-core-freertos-lwip-mbedtls.mtb: <a href="https://github.com/Infineon/wifi-core-freertos-lwip-mbedtls#latest-v1.X#$$ASSET_REPO$$/wifi-core-freertos-lwip-mbedtls/latest-v1.X">https://github.com/Infineon/wifi-core-freertos-lwip-mbedtls#latest-v1.X#$$ASSET_REPO$$/wifi-core-freertos-lwip-mbedtls/latest-v1.X</a></li>
<li>http-server.mtb: <a href="https://github.com/Infineon/http-server#latest-v2.X#$$ASSET_REPO$$/http-server/latest-v2.X">https://github.com/Infineon/http-server#latest-v2.X#$$ASSET_REPO$$/http-server/latest-v2.X</a></li>
</ul>
</li>
<li>To use http-server library with Ethernet kits on FreeRTOS, lwIP, and Mbed TLS combination, the application should pull <a href="https://github.com/Infineon/http-server">http-server</a> library and <a href="https://github.com/Infineon/ethernet-core-freertos-lwip-mbedtls">ethernet-core-freertos-lwip-mbedtls</a> library which will internally pull secure-sockets, ethernet-connection-manager, FreeRTOS, lwIP, Mbed TLS and other dependent modules. To pull ethernet-core-freertos-lwip-mbedtls and http-server libraries create the following *.mtb* files in deps folder.<ul>
<li>ethernet-core-freertos-lwip-mbedtls.mtb: <a href="https://github.com/Infineon/ethernet-core-freertos-lwip-mbedtls#latest-v1.X#$$ASSET_REPO$$/ethernet-core-freertos-lwip-mbedtls/latest-v1.X">https://github.com/Infineon/ethernet-core-freertos-lwip-mbedtls#latest-v1.X#$$ASSET_REPO$$/ethernet-core-freertos-lwip-mbedtls/latest-v1.X</a></li>
<li>http-server.mtb: <a href="https://github.com/Infineon/http-server#latest-v2.X#$$ASSET_REPO$$/http-server/latest-v2.X">https://github.com/Infineon/http-server#latest-v2.X#$$ASSET_REPO$$/http-server/latest-v2.X</a></li>
</ul>
</li>
<li>Review and make the required changes to the pre-defined configuration files.<ul>
<li>The configuration files are bundled with the wifi-core-freertos-lwip-mbedtls library for FreeRTOS, lwIP, and Mbed TLS. See <a href="https://github.com/Infineon/wifi-core-freertos-lwip-mbedtls/blob/master/README.md">README.md</a> for more details.</li>
<li>If the application is using bundle library then the configuration files are in the bundle library. For example if the application is using <em>Wi-Fi core freertos lwip mbedtls bundle library</em>, the configuration files are in <code>wifi-core-freertos-lwip-mbedtls/configs</code> folder. Similarly if the application is using <em>Ethernet Core FreeRTOS lwIP mbedtls library</em>, the configuration files are in <code>ethernet-core-freertos-lwip-mbedtls/configs</code> folder.</li>
</ul>
</li>
<li>Define following COMPONENTS in the application's makefile for the HTTP Server Library. For additional information, see the "Quick Start" section in <a href="https://github.com/Infineon/wifi-core-freertos-lwip-mbedtls/blob/master/README.md">README.md</a>. <div class="fragment"><div class="line">COMPONENTS=FREERTOS MBEDTLS LWIP SECURE_SOCKETS</div>
</div><!-- fragment --></li>
<li>HTTP Server Library disables all the debug log messages by default. To enable log messages, the application must perform the following: <br  />
<ul>
<li>Add <code>ENABLE_HTTP_SERVER_LOGS</code> macro to the <em>DEFINES</em> in the code example's Makefile. The Makefile entry would look like as follows: <div class="fragment"><div class="line">DEFINES+=ENABLE_HTTP_SERVER_LOGS</div>
</div><!-- fragment --></li>
<li>Call the <code>cy_log_init()</code> function provided by the <em>cy-log</em> module. cy-log is part of the <em>connectivity-utilities</em> library. See <a href="https://Infineon.github.io/connectivity-utilities/api_reference_manual/html/group__logging__utils.html">connectivity-utilities library API documentation</a> for cy-log details.</li>
</ul>
</li>
<li>Define the following macro in application's makefile to configure the maximum number of HTTP server resources to 'N': <div class="fragment"><div class="line">DEFINES+=<a class="code hl_define" href="group__http__server__defines.html#ga6e47b484776a72216039a2af358bcedc">MAX_NUMBER_OF_HTTP_SERVER_RESOURCES</a>=&lt;N&gt;</div>
<div class="ttc" id="agroup__http__server__defines_html_ga6e47b484776a72216039a2af358bcedc"><div class="ttname"><a href="group__http__server__defines.html#ga6e47b484776a72216039a2af358bcedc">MAX_NUMBER_OF_HTTP_SERVER_RESOURCES</a></div><div class="ttdeci">#define MAX_NUMBER_OF_HTTP_SERVER_RESOURCES</div><div class="ttdoc">Max number of resources supported by the HTTP server.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:124</div></div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="section_code_snippet"></a>
Code Snippets</h1>
<p >This section provides code snippets for this library on ModusToolbox&trade; framework. The code snippets given under this section uses C APIs.</p><ul>
<li>ModusToolbox&trade; - Snippets for HTTP Server create, start, stop, and delete (C implementation).</li>
</ul>
<h1><a class="anchor" id="section_code_snippet_AnyCloud"></a>
ModusToolbox™</h1>
<p >These code snippets demonstrate the initialization of the configuration structures required for the operation such as creating a secure or non-secure connection and registering a static or dynamic resource with the HTTP server. </p>
<h2><a class="anchor" id="snip1"></a>
Code Snippet 1: Creation and Initialization of Handle for Non-Secure HTTP Server</h2>
<p >Creates an HTTP server handle for a non-secure HTTP connection using the <a class="el" href="group__group__c__api__functions.html#ga1ca51f61222e3aed87c0a15955e2e269">cy_http_server_create</a> API function. </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div>
<div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define HTTP_PORT         80</span></div>
<div class="line"><span class="preprocessor">#define MAX_SOCKETS       2</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="group__http__server__struct.html#ga047ac1c7063077c58da4cc991ad3b1bf">cy_http_server_t</a>          httpSer_1;</div>
<div class="line">cy_network_interface_t    nw_interface_1;</div>
<div class="line">cy_socket_sockaddr_t      IP_address_1;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> snippet_http_non_secure_create(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Status variables for various operations */</span></div>
<div class="line">    cy_rslt_t TestRes = <a class="code hl_define" href="group__http__server__defines.html#gaf18faa0179a6087e4b03d9a81d02010e">CY_RSLT_ERROR</a>;</div>
<div class="line">    (void)TestRes;</div>
<div class="line">    <span class="comment">/* IP address of the server */</span></div>
<div class="line">    IP_address_1.ip_address.ip.v4 = SERVER_IP_ADDRESS;</div>
<div class="line">    IP_address_1.ip_address.version = CY_SOCKET_IP_VER_V4;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add the IP_address information to the network interface object */</span></div>
<div class="line">    nw_interface_1.object  = (<span class="keywordtype">void</span> *) &amp;IP_address_1;</div>
<div class="line">    nw_interface_1.type = CY_NW_INF_TYPE_WIFI;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize the network socket */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga74c8a85310d1537177f80adaef20cfd9">cy_http_server_network_init</a>();</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga1ca51f61222e3aed87c0a15955e2e269">cy_http_server_create</a>( &amp;nw_interface_1, HTTP_PORT, MAX_SOCKETS, NULL, &amp;httpSer_1 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__group__c__api__functions_html_ga1ca51f61222e3aed87c0a15955e2e269"><div class="ttname"><a href="group__group__c__api__functions.html#ga1ca51f61222e3aed87c0a15955e2e269">cy_http_server_create</a></div><div class="ttdeci">cy_rslt_t cy_http_server_create(cy_network_interface_t *interface, uint16_t port, uint16_t max_connection, cy_https_server_security_info_t *security_info, cy_http_server_t *server_handle)</div><div class="ttdoc">Creates a HTTP server instance and initializes its members based on the supplied arguments.</div></div>
<div class="ttc" id="agroup__group__c__api__functions_html_ga74c8a85310d1537177f80adaef20cfd9"><div class="ttname"><a href="group__group__c__api__functions.html#ga74c8a85310d1537177f80adaef20cfd9">cy_http_server_network_init</a></div><div class="ttdeci">cy_rslt_t cy_http_server_network_init(void)</div><div class="ttdoc">One-time initialization function for network sockets implementation.</div></div>
<div class="ttc" id="agroup__http__server__defines_html_gaf18faa0179a6087e4b03d9a81d02010e"><div class="ttname"><a href="group__http__server__defines.html#gaf18faa0179a6087e4b03d9a81d02010e">CY_RSLT_ERROR</a></div><div class="ttdeci">#define CY_RSLT_ERROR</div><div class="ttdoc">HTTP server generic error.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:117</div></div>
<div class="ttc" id="agroup__http__server__struct_html_ga047ac1c7063077c58da4cc991ad3b1bf"><div class="ttname"><a href="group__http__server__struct.html#ga047ac1c7063077c58da4cc991ad3b1bf">cy_http_server_t</a></div><div class="ttdeci">void * cy_http_server_t</div><div class="ttdoc">HTTP server handle.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:243</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="snip2"></a>
Code Snippet 2:  Creation and Initialization of Handle for Secure HTTP Server</h2>
<p >Creates an HTTP server handle for a secure HTTP connection using the <a class="el" href="group__group__c__api__functions.html#ga1ca51f61222e3aed87c0a15955e2e269">cy_http_server_create</a> API function. </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div>
<div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define HTTPS_PORT             443</span></div>
<div class="line"><span class="preprocessor">#define MAX_SOCKETS            2</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Configure the following credentials for a secure HTTP connection */</span></div>
<div class="line"><span class="comment">/* SSL server certificate */</span></div>
<div class="line"><span class="preprocessor">#define SSL_SERVERCERT_PEM      \</span></div>
<div class="line"><span class="preprocessor">&quot;-----BEGIN CERTIFICATE-----\n&quot;</span> \</div>
<div class="line">&quot;........base64 data........\n&quot; \</div>
<div class="line">&quot;-----END CERTIFICATE-----&quot;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* SSL server private key */</span></div>
<div class="line"><span class="preprocessor">#define SSL_SERVERKEY_PEM          \</span></div>
<div class="line"><span class="preprocessor">&quot;-----BEGIN RSA PRIVATE KEY-----\n&quot;</span> \</div>
<div class="line">&quot;..........base64 data..........\n&quot; \</div>
<div class="line">&quot;-----END RSA PRIVATE KEY-----&quot;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="group__http__server__struct.html#ga047ac1c7063077c58da4cc991ad3b1bf">cy_http_server_t</a>          httpSer_2;</div>
<div class="line">cy_network_interface_t    nw_interface_2;</div>
<div class="line">cy_socket_sockaddr_t      IP_address_2;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> snippet_http_secure_create(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Status variables for various operations */</span></div>
<div class="line">    cy_rslt_t TestRes = <a class="code hl_define" href="group__http__server__defines.html#gaf18faa0179a6087e4b03d9a81d02010e">CY_RSLT_ERROR</a>;</div>
<div class="line">    (void)TestRes;</div>
<div class="line">    <a class="code hl_struct" href="structcy__https__server__security__info__t.html">cy_https_server_security_info_t</a> security_cred;</div>
<div class="line"> </div>
<div class="line">    security_cred.<a class="code hl_variable" href="structcy__https__server__security__info__t.html#ac99aee7927d640ff6dfbe200dc44d8ae">certificate</a>                = (uint8_t*) SSL_SERVERCERT_PEM;</div>
<div class="line">    security_cred.<a class="code hl_variable" href="structcy__https__server__security__info__t.html#a3025afbe193cd4e514a711f09d3024e4">certificate_length</a>         = strlen(SSL_SERVERCERT_PEM);</div>
<div class="line">    security_cred.<a class="code hl_variable" href="structcy__https__server__security__info__t.html#ab0df9038e60cccd0e8812c813c6b4c13">private_key</a>                = (uint8_t*) SSL_SERVERKEY_PEM;</div>
<div class="line">    security_cred.<a class="code hl_variable" href="structcy__https__server__security__info__t.html#ad9a1a0499abc77950cfde7aa19a9e3a2">key_length</a>                 = strlen(SSL_SERVERKEY_PEM);</div>
<div class="line">    security_cred.<a class="code hl_variable" href="structcy__https__server__security__info__t.html#af85967438ec03bba793c57ea2f7d1b2c">root_ca_certificate</a>        = NULL;</div>
<div class="line">    security_cred.<a class="code hl_variable" href="structcy__https__server__security__info__t.html#a1b1bd39e4abc48f6789b001c7d67a554">root_ca_certificate_length</a> = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* IP address of the server */</span></div>
<div class="line">    IP_address_2.ip_address.ip.v4 = SERVER_IP_ADDRESS;</div>
<div class="line">    IP_address_2.ip_address.version = CY_SOCKET_IP_VER_V4;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add the IP_address information to the network interface object */</span></div>
<div class="line">    nw_interface_2.object  = (<span class="keywordtype">void</span> *) &amp;IP_address_2;</div>
<div class="line">    nw_interface_2.type = CY_NW_INF_TYPE_WIFI;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize the network socket */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga74c8a85310d1537177f80adaef20cfd9">cy_http_server_network_init</a>();</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga1ca51f61222e3aed87c0a15955e2e269">cy_http_server_create</a>( &amp;nw_interface_2, HTTPS_PORT, MAX_SOCKETS, &amp;security_cred, &amp;httpSer_2 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="astructcy__https__server__security__info__t_html"><div class="ttname"><a href="structcy__https__server__security__info__t.html">cy_https_server_security_info_t</a></div><div class="ttdoc">HTTP server security info.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:287</div></div>
<div class="ttc" id="astructcy__https__server__security__info__t_html_a1b1bd39e4abc48f6789b001c7d67a554"><div class="ttname"><a href="structcy__https__server__security__info__t.html#a1b1bd39e4abc48f6789b001c7d67a554">cy_https_server_security_info_t::root_ca_certificate_length</a></div><div class="ttdeci">uint16_t root_ca_certificate_length</div><div class="ttdoc">Root CA certificate length excluding 'null' termination character.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:293</div></div>
<div class="ttc" id="astructcy__https__server__security__info__t_html_a3025afbe193cd4e514a711f09d3024e4"><div class="ttname"><a href="structcy__https__server__security__info__t.html#a3025afbe193cd4e514a711f09d3024e4">cy_https_server_security_info_t::certificate_length</a></div><div class="ttdeci">uint16_t certificate_length</div><div class="ttdoc">HTTP server certificate length excluding 'null' termination character.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:291</div></div>
<div class="ttc" id="astructcy__https__server__security__info__t_html_ab0df9038e60cccd0e8812c813c6b4c13"><div class="ttname"><a href="structcy__https__server__security__info__t.html#ab0df9038e60cccd0e8812c813c6b4c13">cy_https_server_security_info_t::private_key</a></div><div class="ttdeci">uint8_t * private_key</div><div class="ttdoc">HTTP server private key (base64 encoded)</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:288</div></div>
<div class="ttc" id="astructcy__https__server__security__info__t_html_ac99aee7927d640ff6dfbe200dc44d8ae"><div class="ttname"><a href="structcy__https__server__security__info__t.html#ac99aee7927d640ff6dfbe200dc44d8ae">cy_https_server_security_info_t::certificate</a></div><div class="ttdeci">uint8_t * certificate</div><div class="ttdoc">HTTP server certificate.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:290</div></div>
<div class="ttc" id="astructcy__https__server__security__info__t_html_ad9a1a0499abc77950cfde7aa19a9e3a2"><div class="ttname"><a href="structcy__https__server__security__info__t.html#ad9a1a0499abc77950cfde7aa19a9e3a2">cy_https_server_security_info_t::key_length</a></div><div class="ttdeci">uint16_t key_length</div><div class="ttdoc">HTTP server private key length excluding 'null' termination character.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:289</div></div>
<div class="ttc" id="astructcy__https__server__security__info__t_html_af85967438ec03bba793c57ea2f7d1b2c"><div class="ttname"><a href="structcy__https__server__security__info__t.html#af85967438ec03bba793c57ea2f7d1b2c">cy_https_server_security_info_t::root_ca_certificate</a></div><div class="ttdeci">uint8_t * root_ca_certificate</div><div class="ttdoc">Root CA certificate to verify client certificate.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:292</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="snip3"></a>
Code Snippet 3: Registering a Static Resource</h2>
<p >Registers a static resource with the HTTP server using the <a class="el" href="group__group__c__api__functions.html#gad03c8e19c0792c4307356e52ba3006ee">cy_http_server_register_resource</a> API function. </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div>
<div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define HTTP_PORT            80</span></div>
<div class="line"><span class="preprocessor">#define MAX_SOCKETS          2</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* HTML page sent in response to the client */</span></div>
<div class="line"><span class="preprocessor">#define CAPTIVE_PORTAL_REDIRECT_PAGE \</span></div>
<div class="line"><span class="preprocessor">&quot;&lt;html&gt;&lt;head&gt;&quot;</span> \</div>
<div class="line">&quot;Hello, This is a reference HTTP server application&quot; \</div>
<div class="line">&quot;&lt;/head&gt;&lt;/html&gt;&quot;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="group__http__server__struct.html#ga047ac1c7063077c58da4cc991ad3b1bf">cy_http_server_t</a>          httpSer_3;</div>
<div class="line">cy_network_interface_t    nw_interface_3;</div>
<div class="line">cy_socket_sockaddr_t      IP_address_3;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> snippet_http_static_reg_resource(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Status variables for various operations */</span></div>
<div class="line">    cy_rslt_t TestRes = <a class="code hl_define" href="group__http__server__defines.html#gaf18faa0179a6087e4b03d9a81d02010e">CY_RSLT_ERROR</a>;</div>
<div class="line">    (void)TestRes;</div>
<div class="line">    <span class="comment">/* IP address of the server */</span></div>
<div class="line">    IP_address_3.ip_address.ip.v4 = SERVER_IP_ADDRESS;</div>
<div class="line">    IP_address_3.ip_address.version = CY_SOCKET_IP_VER_V4;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add the IP_address information to the network interface object */</span></div>
<div class="line">    nw_interface_3.object  = (<span class="keywordtype">void</span> *) &amp;IP_address_3;</div>
<div class="line">    nw_interface_3.type = CY_NW_INF_TYPE_WIFI;</div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* Initialize the network socket */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga74c8a85310d1537177f80adaef20cfd9">cy_http_server_network_init</a>();</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga1ca51f61222e3aed87c0a15955e2e269">cy_http_server_create</a>( &amp;nw_interface_3, HTTP_PORT, MAX_SOCKETS, NULL, &amp;httpSer_3 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Register a static resource with the HTTP server */</span></div>
<div class="line">    <a class="code hl_struct" href="structcy__resource__static__data__t.html">cy_resource_static_data_t</a> static_resource;</div>
<div class="line">    static_resource.<a class="code hl_variable" href="structcy__resource__static__data__t.html#a898a2959797f5d333f70915e27c8f8bf">data</a> = CAPTIVE_PORTAL_REDIRECT_PAGE;</div>
<div class="line">    static_resource.<a class="code hl_variable" href="structcy__resource__static__data__t.html#a288d94a277b56b226480d6d18e7787ce">length</a> = <span class="keyword">sizeof</span>( CAPTIVE_PORTAL_REDIRECT_PAGE );</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#gad03c8e19c0792c4307356e52ba3006ee">cy_http_server_register_resource</a>( httpSer_3, (uint8_t*) <span class="stringliteral">&quot;/get&quot;</span>, (uint8_t*)<span class="stringliteral">&quot;text/html&quot;</span>, <a class="code hl_enumvalue" href="group__http__server__struct.html#gga32d601085911dbd59b7ecd50a6b7f584a16c98c125133981542d412c2449988a1">CY_STATIC_URL_CONTENT</a>, &amp;static_resource);</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__group__c__api__functions_html_gad03c8e19c0792c4307356e52ba3006ee"><div class="ttname"><a href="group__group__c__api__functions.html#gad03c8e19c0792c4307356e52ba3006ee">cy_http_server_register_resource</a></div><div class="ttdeci">cy_rslt_t cy_http_server_register_resource(cy_http_server_t server_handle, uint8_t *url, uint8_t *mime_type, cy_url_resource_type url_resource_type, void *resource_data)</div><div class="ttdoc">Used to register a resource(static/dynamic) with the HTTP server.</div></div>
<div class="ttc" id="agroup__http__server__struct_html_gga32d601085911dbd59b7ecd50a6b7f584a16c98c125133981542d412c2449988a1"><div class="ttname"><a href="group__http__server__struct.html#gga32d601085911dbd59b7ecd50a6b7f584a16c98c125133981542d412c2449988a1">CY_STATIC_URL_CONTENT</a></div><div class="ttdeci">@ CY_STATIC_URL_CONTENT</div><div class="ttdoc">Page is constant data in memory-addressable area.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:231</div></div>
<div class="ttc" id="astructcy__resource__static__data__t_html"><div class="ttname"><a href="structcy__resource__static__data__t.html">cy_resource_static_data_t</a></div><div class="ttdoc">Static HTTP resource info.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:305</div></div>
<div class="ttc" id="astructcy__resource__static__data__t_html_a288d94a277b56b226480d6d18e7787ce"><div class="ttname"><a href="structcy__resource__static__data__t.html#a288d94a277b56b226480d6d18e7787ce">cy_resource_static_data_t::length</a></div><div class="ttdeci">uint32_t length</div><div class="ttdoc">The length in bytes of the page/file.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:307</div></div>
<div class="ttc" id="astructcy__resource__static__data__t_html_a898a2959797f5d333f70915e27c8f8bf"><div class="ttname"><a href="structcy__resource__static__data__t.html#a898a2959797f5d333f70915e27c8f8bf">cy_resource_static_data_t::data</a></div><div class="ttdeci">const void * data</div><div class="ttdoc">A pointer to the data for the page/file resource.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:306</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="snip4"></a>
Code Snippet 4: Registering a Dynamic Resource</h2>
<p >Registers a dynamic resource with the HTTP server using the <a class="el" href="group__group__c__api__functions.html#gad03c8e19c0792c4307356e52ba3006ee">cy_http_server_register_resource</a> API function. </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div>
<div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define HTTP_PORT            80</span></div>
<div class="line"><span class="preprocessor">#define MAX_SOCKETS          2</span></div>
<div class="line"><span class="preprocessor">#define BUFFER_LENGTH        1500</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* HTML page sent in response to the client */</span></div>
<div class="line"><span class="preprocessor">#define CAPTIVE_PORTAL_REDIRECT_PAGE \</span></div>
<div class="line"><span class="preprocessor">&quot;&lt;html&gt;&lt;head&gt;&quot;</span> \</div>
<div class="line">&quot;Hello, This is a reference HTTP server application&quot; \</div>
<div class="line">&quot;&lt;/head&gt;&lt;/html&gt;&quot;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="group__http__server__struct.html#ga047ac1c7063077c58da4cc991ad3b1bf">cy_http_server_t</a>          httpSer_4;</div>
<div class="line">cy_network_interface_t    nw_interface_4;</div>
<div class="line">cy_socket_sockaddr_t      IP_address_4;</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span>               buffer[BUFFER_LENGTH];</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span>                length = 0;</div>
<div class="line"> </div>
<div class="line">int32_t process_handler( <span class="keyword">const</span> <span class="keywordtype">char</span>* url_path, <span class="keyword">const</span> <span class="keywordtype">char</span>* url_parameters, <a class="code hl_struct" href="structcy__http__response__stream__t.html">cy_http_response_stream_t</a>* stream,</div>
<div class="line">                         <span class="keywordtype">void</span>* arg, <a class="code hl_struct" href="structcy__http__message__body__t.html">cy_http_message_body_t</a>* http_message_body )</div>
<div class="line">{</div>
<div class="line">    memset(buffer, 0, BUFFER_LENGTH);</div>
<div class="line">    memcpy( buffer, http_message_body-&gt;<a class="code hl_variable" href="structcy__http__message__body__t.html#a3d07565cc43cf954e63ebaa5c2db1ca6">data</a>, http_message_body-&gt;<a class="code hl_variable" href="structcy__http__message__body__t.html#a3cfde2375f1e55e21bd204a8f843f473">data_length</a>);</div>
<div class="line">    length += http_message_body-&gt;<a class="code hl_variable" href="structcy__http__message__body__t.html#a3cfde2375f1e55e21bd204a8f843f473">data_length</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (http_message_body-&gt;<a class="code hl_variable" href="structcy__http__message__body__t.html#afeaaa983c593be6dc2ba404ea086d44c">data_remaining</a> == 0)</div>
<div class="line">    {</div>
<div class="line">        <a class="code hl_function" href="group__group__c__api__functions.html#ga743dd1f394056a6ac09a6d4d8f17035c">cy_http_server_response_stream_write_payload</a>(stream, CAPTIVE_PORTAL_REDIRECT_PAGE, <span class="keyword">sizeof</span>(CAPTIVE_PORTAL_REDIRECT_PAGE));</div>
<div class="line">        length = 0;</div>
<div class="line">        memset(buffer, 0, BUFFER_LENGTH);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> snippet_http_dynamic_reg_resource(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Status variables for various operations */</span></div>
<div class="line">    cy_rslt_t TestRes = <a class="code hl_define" href="group__http__server__defines.html#gaf18faa0179a6087e4b03d9a81d02010e">CY_RSLT_ERROR</a>;</div>
<div class="line">    (void)TestRes;</div>
<div class="line">    <span class="comment">/* IP address of the server */</span></div>
<div class="line">    IP_address_4.ip_address.ip.v4 = SERVER_IP_ADDRESS;</div>
<div class="line">    IP_address_4.ip_address.version = CY_SOCKET_IP_VER_V4;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add the IP_address information to the network interface object */</span></div>
<div class="line">    nw_interface_4.object  = (<span class="keywordtype">void</span> *) &amp;IP_address_4;</div>
<div class="line">    nw_interface_4.type = CY_NW_INF_TYPE_WIFI;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize the network socket */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga74c8a85310d1537177f80adaef20cfd9">cy_http_server_network_init</a>();</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga1ca51f61222e3aed87c0a15955e2e269">cy_http_server_create</a>( &amp;nw_interface_4, HTTP_PORT, MAX_SOCKETS, NULL, &amp;httpSer_4 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Register a dynamic resource with the HTTP server */</span></div>
<div class="line">    <a class="code hl_struct" href="structcy__resource__dynamic__data__t.html">cy_resource_dynamic_data_t</a> dynamic_resource;</div>
<div class="line">    dynamic_resource.<a class="code hl_variable" href="structcy__resource__dynamic__data__t.html#a2fa3f6203db2348184a4cd0409c1d6cb">resource_handler</a> = process_handler;</div>
<div class="line">    dynamic_resource.<a class="code hl_variable" href="structcy__resource__dynamic__data__t.html#a21189a067fa29eb836db706aa3553f2b">arg</a> = NULL;</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#gad03c8e19c0792c4307356e52ba3006ee">cy_http_server_register_resource</a>( httpSer_4, (uint8_t*) <span class="stringliteral">&quot;/post&quot;</span>, (uint8_t*)<span class="stringliteral">&quot;text/html&quot;</span>, <a class="code hl_enumvalue" href="group__http__server__struct.html#gga32d601085911dbd59b7ecd50a6b7f584ab61d536399015bfa53ede0e680aae9f7">CY_DYNAMIC_URL_CONTENT</a>, &amp;dynamic_resource);</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__group__c__api__functions_html_ga743dd1f394056a6ac09a6d4d8f17035c"><div class="ttname"><a href="group__group__c__api__functions.html#ga743dd1f394056a6ac09a6d4d8f17035c">cy_http_server_response_stream_write_payload</a></div><div class="ttdeci">cy_rslt_t cy_http_server_response_stream_write_payload(cy_http_response_stream_t *stream, const void *data, uint32_t length)</div><div class="ttdoc">Writes data to the HTTP stream.</div></div>
<div class="ttc" id="agroup__http__server__struct_html_gga32d601085911dbd59b7ecd50a6b7f584ab61d536399015bfa53ede0e680aae9f7"><div class="ttname"><a href="group__http__server__struct.html#gga32d601085911dbd59b7ecd50a6b7f584ab61d536399015bfa53ede0e680aae9f7">CY_DYNAMIC_URL_CONTENT</a></div><div class="ttdeci">@ CY_DYNAMIC_URL_CONTENT</div><div class="ttdoc">Page is dynamically generated by a url_processor_t type function.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:232</div></div>
<div class="ttc" id="astructcy__http__message__body__t_html"><div class="ttname"><a href="structcy__http__message__body__t.html">cy_http_message_body_t</a></div><div class="ttdoc">HTTP message structure that gets passed to dynamic URL processor functions.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:252</div></div>
<div class="ttc" id="astructcy__http__message__body__t_html_a3cfde2375f1e55e21bd204a8f843f473"><div class="ttname"><a href="structcy__http__message__body__t.html#a3cfde2375f1e55e21bd204a8f843f473">cy_http_message_body_t::data_length</a></div><div class="ttdeci">uint16_t data_length</div><div class="ttdoc">Data length in current packet</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:254</div></div>
<div class="ttc" id="astructcy__http__message__body__t_html_a3d07565cc43cf954e63ebaa5c2db1ca6"><div class="ttname"><a href="structcy__http__message__body__t.html#a3d07565cc43cf954e63ebaa5c2db1ca6">cy_http_message_body_t::data</a></div><div class="ttdeci">const uint8_t * data</div><div class="ttdoc">Packet data in message body</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:253</div></div>
<div class="ttc" id="astructcy__http__message__body__t_html_afeaaa983c593be6dc2ba404ea086d44c"><div class="ttname"><a href="structcy__http__message__body__t.html#afeaaa983c593be6dc2ba404ea086d44c">cy_http_message_body_t::data_remaining</a></div><div class="ttdeci">uint32_t data_remaining</div><div class="ttdoc">Data yet to be consumed</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:255</div></div>
<div class="ttc" id="astructcy__http__response__stream__t_html"><div class="ttname"><a href="structcy__http__response__stream__t.html">cy_http_response_stream_t</a></div><div class="ttdoc">Context structure for HTTP server stream Users should not access these values - they are provided her...</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:267</div></div>
<div class="ttc" id="astructcy__resource__dynamic__data__t_html"><div class="ttname"><a href="structcy__resource__dynamic__data__t.html">cy_resource_dynamic_data_t</a></div><div class="ttdoc">Dynamic HTTP resource info.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:298</div></div>
<div class="ttc" id="astructcy__resource__dynamic__data__t_html_a21189a067fa29eb836db706aa3553f2b"><div class="ttname"><a href="structcy__resource__dynamic__data__t.html#a21189a067fa29eb836db706aa3553f2b">cy_resource_dynamic_data_t::arg</a></div><div class="ttdeci">void * arg</div><div class="ttdoc">Argument to be passed to the generator function</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:300</div></div>
<div class="ttc" id="astructcy__resource__dynamic__data__t_html_a2fa3f6203db2348184a4cd0409c1d6cb"><div class="ttname"><a href="structcy__resource__dynamic__data__t.html#a2fa3f6203db2348184a4cd0409c1d6cb">cy_resource_dynamic_data_t::resource_handler</a></div><div class="ttdeci">url_processor_t resource_handler</div><div class="ttdoc">The function that will handle requests for this page.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:299</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="snip5"></a>
Code Snippet 5: Registering a Server-Sent Event (SSE)</h2>
<p >Registers a Server-Sent Event using the <a class="el" href="group__group__c__api__functions.html#gad03c8e19c0792c4307356e52ba3006ee">cy_http_server_register_resource</a> API function. </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div>
<div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define HTTP_PORT                80</span></div>
<div class="line"><span class="preprocessor">#define MAX_SOCKETS              2</span></div>
<div class="line"><span class="preprocessor">#define CHUNKED_CONTENT_LENGTH   0</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="group__http__server__struct.html#ga047ac1c7063077c58da4cc991ad3b1bf">cy_http_server_t</a>               httpSer_5;</div>
<div class="line">cy_network_interface_t         nw_interface_5;</div>
<div class="line"><a class="code hl_struct" href="structcy__http__response__stream__t.html">cy_http_response_stream_t</a>*     http_event_stream_5;</div>
<div class="line">cy_socket_sockaddr_t           IP_address_5;</div>
<div class="line"> </div>
<div class="line">int32_t anycloud_process_SSE_handler( <span class="keyword">const</span> <span class="keywordtype">char</span>* url_path, <span class="keyword">const</span> <span class="keywordtype">char</span>* url_parameters,</div>
<div class="line">                                      <a class="code hl_struct" href="structcy__http__response__stream__t.html">cy_http_response_stream_t</a>* stream, <span class="keywordtype">void</span>* arg,</div>
<div class="line">                                      <a class="code hl_struct" href="structcy__http__message__body__t.html">cy_http_message_body_t</a>* http_message_body )</div>
<div class="line">{</div>
<div class="line">    http_event_stream_5 = stream;</div>
<div class="line">    <span class="comment">/* Enable chunked transfer encoding on the HTTP stream */</span></div>
<div class="line">    <a class="code hl_function" href="group__group__c__api__functions.html#gaf4743c3b0e6ef9ba4afc5e1b5531691f">cy_http_server_response_stream_enable_chunked_transfer</a>( http_event_stream_5 );</div>
<div class="line">    <a class="code hl_function" href="group__group__c__api__functions.html#gafb8df6439fdadb46d738ecd43cbaf002">cy_http_server_response_stream_write_header</a>( http_event_stream_5, <a class="code hl_enumvalue" href="group__http__server__struct.html#ggad1b0486d4ab51b5b1969e54aae1e5eddad3dbd9c89c618dff06785fdd77ec0419">CY_HTTP_200_TYPE</a>, CHUNKED_CONTENT_LENGTH,</div>
<div class="line">                                               <a class="code hl_enumvalue" href="group__http__server__struct.html#gga64b862dacedd67c3d74845c1a6038b89a21676ce46eff61339e33dded1daeaaea">CY_HTTP_CACHE_DISABLED</a>, MIME_TYPE_TEXT_EVENT_STREAM );</div>
<div class="line">    <span class="comment">/* Disable chunked transfer encoding on the HTTP stream after header write is completed */</span></div>
<div class="line">    <a class="code hl_function" href="group__group__c__api__functions.html#gab24071765e97d90225a33ead1318298e">cy_http_server_response_stream_disable_chunked_transfer</a>( http_event_stream_5 );</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> snippet_http_server_event_reg(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Status variables for various operations */</span></div>
<div class="line">    cy_rslt_t TestRes = <a class="code hl_define" href="group__http__server__defines.html#gaf18faa0179a6087e4b03d9a81d02010e">CY_RSLT_ERROR</a>;</div>
<div class="line">    (void)TestRes;</div>
<div class="line">    <span class="comment">/* IP address of the server */</span></div>
<div class="line">    IP_address_5.ip_address.ip.v4 = SERVER_IP_ADDRESS;</div>
<div class="line">    IP_address_5.ip_address.version = CY_SOCKET_IP_VER_V4;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add the IP_address information to the network interface object */</span></div>
<div class="line">    nw_interface_5.object  = (<span class="keywordtype">void</span> *) &amp;IP_address_5;</div>
<div class="line">    nw_interface_5.type = CY_NW_INF_TYPE_WIFI;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize the network socket */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga74c8a85310d1537177f80adaef20cfd9">cy_http_server_network_init</a>();</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga1ca51f61222e3aed87c0a15955e2e269">cy_http_server_create</a>( &amp;nw_interface_5, HTTP_PORT, MAX_SOCKETS, NULL, &amp;httpSer_5 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_struct" href="structcy__resource__dynamic__data__t.html">cy_resource_dynamic_data_t</a> dynamic_sse_resource;</div>
<div class="line">    dynamic_sse_resource.<a class="code hl_variable" href="structcy__resource__dynamic__data__t.html#a2fa3f6203db2348184a4cd0409c1d6cb">resource_handler</a> = anycloud_process_SSE_handler;</div>
<div class="line">    dynamic_sse_resource.<a class="code hl_variable" href="structcy__resource__dynamic__data__t.html#a21189a067fa29eb836db706aa3553f2b">arg</a> = NULL;</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#gad03c8e19c0792c4307356e52ba3006ee">cy_http_server_register_resource</a>( httpSer_5, (uint8_t*) <span class="stringliteral">&quot;/events&quot;</span>, (uint8_t*)<span class="stringliteral">&quot;text/event-stream&quot;</span>, <a class="code hl_enumvalue" href="group__http__server__struct.html#gga32d601085911dbd59b7ecd50a6b7f584a6b8d1cd5fef8b7ffc82c06591b8e3bc1">CY_RAW_DYNAMIC_URL_CONTENT</a>, &amp;dynamic_sse_resource);</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__group__c__api__functions_html_gab24071765e97d90225a33ead1318298e"><div class="ttname"><a href="group__group__c__api__functions.html#gab24071765e97d90225a33ead1318298e">cy_http_server_response_stream_disable_chunked_transfer</a></div><div class="ttdeci">cy_rslt_t cy_http_server_response_stream_disable_chunked_transfer(cy_http_response_stream_t *stream)</div><div class="ttdoc">Disables chunked transfer encoding on the HTTP stream.</div></div>
<div class="ttc" id="agroup__group__c__api__functions_html_gaf4743c3b0e6ef9ba4afc5e1b5531691f"><div class="ttname"><a href="group__group__c__api__functions.html#gaf4743c3b0e6ef9ba4afc5e1b5531691f">cy_http_server_response_stream_enable_chunked_transfer</a></div><div class="ttdeci">cy_rslt_t cy_http_server_response_stream_enable_chunked_transfer(cy_http_response_stream_t *stream)</div><div class="ttdoc">Enables chunked transfer encoding on the HTTP stream.</div></div>
<div class="ttc" id="agroup__group__c__api__functions_html_gafb8df6439fdadb46d738ecd43cbaf002"><div class="ttname"><a href="group__group__c__api__functions.html#gafb8df6439fdadb46d738ecd43cbaf002">cy_http_server_response_stream_write_header</a></div><div class="ttdeci">cy_rslt_t cy_http_server_response_stream_write_header(cy_http_response_stream_t *stream, cy_http_status_codes_t status_code, uint32_t content_length, cy_http_cache_t cache_type, cy_http_mime_type_t mime_type)</div><div class="ttdoc">Writes HTTP header to the HTTP stream provided.</div></div>
<div class="ttc" id="agroup__http__server__struct_html_gga32d601085911dbd59b7ecd50a6b7f584a6b8d1cd5fef8b7ffc82c06591b8e3bc1"><div class="ttname"><a href="group__http__server__struct.html#gga32d601085911dbd59b7ecd50a6b7f584a6b8d1cd5fef8b7ffc82c06591b8e3bc1">CY_RAW_DYNAMIC_URL_CONTENT</a></div><div class="ttdeci">@ CY_RAW_DYNAMIC_URL_CONTENT</div><div class="ttdoc">Same as CY_DYNAMIC_URL_CONTENT, but the HTTP header must be supplied as part of the content.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:235</div></div>
<div class="ttc" id="agroup__http__server__struct_html_gga64b862dacedd67c3d74845c1a6038b89a21676ce46eff61339e33dded1daeaaea"><div class="ttname"><a href="group__http__server__struct.html#gga64b862dacedd67c3d74845c1a6038b89a21676ce46eff61339e33dded1daeaaea">CY_HTTP_CACHE_DISABLED</a></div><div class="ttdeci">@ CY_HTTP_CACHE_DISABLED</div><div class="ttdoc">Do not cache previously fetched resources.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:183</div></div>
<div class="ttc" id="agroup__http__server__struct_html_ggad1b0486d4ab51b5b1969e54aae1e5eddad3dbd9c89c618dff06785fdd77ec0419"><div class="ttname"><a href="group__http__server__struct.html#ggad1b0486d4ab51b5b1969e54aae1e5eddad3dbd9c89c618dff06785fdd77ec0419">CY_HTTP_200_TYPE</a></div><div class="ttdeci">@ CY_HTTP_200_TYPE</div><div class="ttdoc">OK.</div><div class="ttdef"><b>Definition:</b> cy_http_server.h:208</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="snip6"></a>
Code Snippet 6: HTTP Server Start</h2>
<p >Starts the HTTP server using the <a class="el" href="group__group__c__api__functions.html#ga3cb020a5e45f80b55ea3fc2eb1c6c3df">cy_http_server_start</a> API function. </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div>
<div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define HTTP_PORT            80</span></div>
<div class="line"><span class="preprocessor">#define MAX_SOCKETS          2</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* HTML page sent in response to the client */</span></div>
<div class="line"><span class="preprocessor">#define CAPTIVE_PORTAL_REDIRECT_PAGE \</span></div>
<div class="line"><span class="preprocessor">&quot;&lt;html&gt;&lt;head&gt;&quot;</span> \</div>
<div class="line">&quot;Hello, This is a reference HTTP server application&quot; \</div>
<div class="line">&quot;&lt;/head&gt;&lt;/html&gt;&quot;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="group__http__server__struct.html#ga047ac1c7063077c58da4cc991ad3b1bf">cy_http_server_t</a>          httpSer_6;</div>
<div class="line">cy_network_interface_t    nw_interface_6;</div>
<div class="line">cy_socket_sockaddr_t      IP_address_6;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> snippet_http_server_start(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Status variables for various operations */</span></div>
<div class="line">    cy_rslt_t TestRes = <a class="code hl_define" href="group__http__server__defines.html#gaf18faa0179a6087e4b03d9a81d02010e">CY_RSLT_ERROR</a>;</div>
<div class="line">    (void)TestRes;</div>
<div class="line">    <span class="comment">/* IP address of the server */</span></div>
<div class="line">    IP_address_6.ip_address.ip.v4 = SERVER_IP_ADDRESS;</div>
<div class="line">    IP_address_6.ip_address.version = CY_SOCKET_IP_VER_V4;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add the IP_address information to the network interface object */</span></div>
<div class="line">    nw_interface_6.object  = (<span class="keywordtype">void</span> *) &amp;IP_address_6;</div>
<div class="line">    nw_interface_6.type = CY_NW_INF_TYPE_WIFI;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize the network socket */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga74c8a85310d1537177f80adaef20cfd9">cy_http_server_network_init</a>();</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga1ca51f61222e3aed87c0a15955e2e269">cy_http_server_create</a>( &amp;nw_interface_6, HTTP_PORT, MAX_SOCKETS, NULL, &amp;httpSer_6 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Register a static resource with the HTTP server */</span></div>
<div class="line">    <a class="code hl_struct" href="structcy__resource__static__data__t.html">cy_resource_static_data_t</a> static_resource;</div>
<div class="line">    static_resource.<a class="code hl_variable" href="structcy__resource__static__data__t.html#a898a2959797f5d333f70915e27c8f8bf">data</a> = CAPTIVE_PORTAL_REDIRECT_PAGE;</div>
<div class="line">    static_resource.<a class="code hl_variable" href="structcy__resource__static__data__t.html#a288d94a277b56b226480d6d18e7787ce">length</a> = <span class="keyword">sizeof</span>( CAPTIVE_PORTAL_REDIRECT_PAGE );</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#gad03c8e19c0792c4307356e52ba3006ee">cy_http_server_register_resource</a>( httpSer_6, (uint8_t*) <span class="stringliteral">&quot;/get&quot;</span>, (uint8_t*)<span class="stringliteral">&quot;text/html&quot;</span>, <a class="code hl_enumvalue" href="group__http__server__struct.html#gga32d601085911dbd59b7ecd50a6b7f584a16c98c125133981542d412c2449988a1">CY_STATIC_URL_CONTENT</a>, &amp;static_resource );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Start HTTP server */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga3cb020a5e45f80b55ea3fc2eb1c6c3df">cy_http_server_start</a>( httpSer_6 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__group__c__api__functions_html_ga3cb020a5e45f80b55ea3fc2eb1c6c3df"><div class="ttname"><a href="group__group__c__api__functions.html#ga3cb020a5e45f80b55ea3fc2eb1c6c3df">cy_http_server_start</a></div><div class="ttdeci">cy_rslt_t cy_http_server_start(cy_http_server_t server_handle)</div><div class="ttdoc">Starts a HTTP server daemon (web server)</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="snip7"></a>
Code Snippet 7: Sending HTTP Server Events</h2>
<p >Sends HTTP server events using the <a class="el" href="group__group__c__api__functions.html#gafb8df6439fdadb46d738ecd43cbaf002">cy_http_server_response_stream_write_header</a> API function. </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div>
<div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define HTTP_PORT              80</span></div>
<div class="line"><span class="preprocessor">#define MAX_SOCKETS            2</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SSE_PAYLOAD            &quot;Hello, This is server sent events \r\n&quot;</span></div>
<div class="line"><span class="preprocessor">#define LFLF                   &quot;\n\n&quot;</span></div>
<div class="line"><span class="preprocessor">#define EVENT_STREAM_DATA      &quot;data: &quot;</span></div>
<div class="line"><span class="preprocessor">#define CHUNKED_CONTENT_LENGTH 0</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="structcy__http__response__stream__t.html">cy_http_response_stream_t</a>*     http_event_stream_7;</div>
<div class="line"><a class="code hl_typedef" href="group__http__server__struct.html#ga047ac1c7063077c58da4cc991ad3b1bf">cy_http_server_t</a>               httpSer_7;</div>
<div class="line">cy_network_interface_t         nw_interface_7;</div>
<div class="line">cy_socket_sockaddr_t           IP_address_7;</div>
<div class="line"> </div>
<div class="line">int32_t process_SSE_handler( <span class="keyword">const</span> <span class="keywordtype">char</span>* url_path, <span class="keyword">const</span> <span class="keywordtype">char</span>* url_parameters,</div>
<div class="line">                                           <a class="code hl_struct" href="structcy__http__response__stream__t.html">cy_http_response_stream_t</a>* stream, <span class="keywordtype">void</span>* arg,</div>
<div class="line">                                           <a class="code hl_struct" href="structcy__http__message__body__t.html">cy_http_message_body_t</a>* http_message_body )</div>
<div class="line">{</div>
<div class="line">    http_event_stream_7 = stream;</div>
<div class="line">    <a class="code hl_function" href="group__group__c__api__functions.html#gaf4743c3b0e6ef9ba4afc5e1b5531691f">cy_http_server_response_stream_enable_chunked_transfer</a>( http_event_stream_7 );</div>
<div class="line">    <a class="code hl_function" href="group__group__c__api__functions.html#gafb8df6439fdadb46d738ecd43cbaf002">cy_http_server_response_stream_write_header</a>( http_event_stream_7, <a class="code hl_enumvalue" href="group__http__server__struct.html#ggad1b0486d4ab51b5b1969e54aae1e5eddad3dbd9c89c618dff06785fdd77ec0419">CY_HTTP_200_TYPE</a>, CHUNKED_CONTENT_LENGTH,</div>
<div class="line">                                                 <a class="code hl_enumvalue" href="group__http__server__struct.html#gga64b862dacedd67c3d74845c1a6038b89a21676ce46eff61339e33dded1daeaaea">CY_HTTP_CACHE_DISABLED</a>, MIME_TYPE_TEXT_EVENT_STREAM );</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> send_events()</div>
<div class="line">{</div>
<div class="line">    cy_rslt_t result;</div>
<div class="line">    <span class="keywordflow">if</span>( http_event_stream_7 == NULL )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    result = <a class="code hl_function" href="group__group__c__api__functions.html#ga743dd1f394056a6ac09a6d4d8f17035c">cy_http_server_response_stream_write_payload</a>( http_event_stream_7, (<span class="keyword">const</span> <span class="keywordtype">void</span>*)EVENT_STREAM_DATA, <span class="keyword">sizeof</span>( EVENT_STREAM_DATA ) - 1 );</div>
<div class="line">    <span class="keywordflow">if</span> ( result != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        http_event_stream_7 = NULL;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Send message to client */</span></div>
<div class="line">    result = <a class="code hl_function" href="group__group__c__api__functions.html#ga743dd1f394056a6ac09a6d4d8f17035c">cy_http_server_response_stream_write_payload</a>( http_event_stream_7, SSE_PAYLOAD, <span class="keyword">sizeof</span>(SSE_PAYLOAD) - 1);</div>
<div class="line">    <span class="keywordflow">if</span> ( result != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        http_event_stream_7 = NULL;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* SSE is ended with two line feeds */</span></div>
<div class="line">    result = <a class="code hl_function" href="group__group__c__api__functions.html#ga743dd1f394056a6ac09a6d4d8f17035c">cy_http_server_response_stream_write_payload</a>( http_event_stream_7, (<span class="keyword">const</span> <span class="keywordtype">void</span>*)LFLF, <span class="keyword">sizeof</span>( LFLF ) - 1 );</div>
<div class="line">    <span class="keywordflow">if</span> ( result != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        http_event_stream_7 = NULL;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> snippet_http_server_send_events(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Status variables for various operations */</span></div>
<div class="line">    cy_rslt_t TestRes = <a class="code hl_define" href="group__http__server__defines.html#gaf18faa0179a6087e4b03d9a81d02010e">CY_RSLT_ERROR</a>;</div>
<div class="line">    (void)TestRes;</div>
<div class="line">    <span class="comment">/* IP address of the server */</span></div>
<div class="line">    IP_address_7.ip_address.ip.v4 = SERVER_IP_ADDRESS;</div>
<div class="line">    IP_address_7.ip_address.version = CY_SOCKET_IP_VER_V4;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add the IP_address information to the network interface object */</span></div>
<div class="line">    nw_interface_7.object  = (<span class="keywordtype">void</span> *) &amp;IP_address_7;</div>
<div class="line">    nw_interface_7.type = CY_NW_INF_TYPE_WIFI;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize the network socket */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga74c8a85310d1537177f80adaef20cfd9">cy_http_server_network_init</a>();</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga1ca51f61222e3aed87c0a15955e2e269">cy_http_server_create</a>( &amp;nw_interface_7, HTTP_PORT, MAX_SOCKETS, NULL, &amp;httpSer_7 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_struct" href="structcy__resource__dynamic__data__t.html">cy_resource_dynamic_data_t</a> dynamic_sse_resource;</div>
<div class="line">    dynamic_sse_resource.<a class="code hl_variable" href="structcy__resource__dynamic__data__t.html#a2fa3f6203db2348184a4cd0409c1d6cb">resource_handler</a> = process_SSE_handler;</div>
<div class="line">    dynamic_sse_resource.<a class="code hl_variable" href="structcy__resource__dynamic__data__t.html#a21189a067fa29eb836db706aa3553f2b">arg</a> = NULL;</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#gad03c8e19c0792c4307356e52ba3006ee">cy_http_server_register_resource</a>( httpSer_7, (uint8_t*) <span class="stringliteral">&quot;/events&quot;</span>, (uint8_t*)<span class="stringliteral">&quot;text/event-stream&quot;</span>, <a class="code hl_enumvalue" href="group__http__server__struct.html#gga32d601085911dbd59b7ecd50a6b7f584a6b8d1cd5fef8b7ffc82c06591b8e3bc1">CY_RAW_DYNAMIC_URL_CONTENT</a>, &amp;dynamic_sse_resource);</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Start HTTP server */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga3cb020a5e45f80b55ea3fc2eb1c6c3df">cy_http_server_start</a>( httpSer_7 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Send server events */</span></div>
<div class="line">    <span class="keywordflow">if</span>( http_event_stream_7 != NULL )</div>
<div class="line">    {</div>
<div class="line">        send_events();</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Disconnect event stream */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#gaf051d4ad577610bdbd38fa6aa8297592">cy_http_server_response_stream_disconnect</a>( http_event_stream_7 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Disconnect all streams */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#gaf6442a83a82a102c4490280d85e0ef88">cy_http_server_response_stream_disconnect_all</a>( httpSer_7 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__group__c__api__functions_html_gaf051d4ad577610bdbd38fa6aa8297592"><div class="ttname"><a href="group__group__c__api__functions.html#gaf051d4ad577610bdbd38fa6aa8297592">cy_http_server_response_stream_disconnect</a></div><div class="ttdeci">cy_rslt_t cy_http_server_response_stream_disconnect(cy_http_response_stream_t *stream)</div><div class="ttdoc">Queues a disconnect request to the HTTP server.</div></div>
<div class="ttc" id="agroup__group__c__api__functions_html_gaf6442a83a82a102c4490280d85e0ef88"><div class="ttname"><a href="group__group__c__api__functions.html#gaf6442a83a82a102c4490280d85e0ef88">cy_http_server_response_stream_disconnect_all</a></div><div class="ttdeci">cy_rslt_t cy_http_server_response_stream_disconnect_all(cy_http_server_t server_handle)</div><div class="ttdoc">Disconnects all the HTTP streams associated with the given server.</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="snip8"></a>
Code Snippet 8: HTTP Server Stop</h2>
<p >Stops the HTTP server using the <a class="el" href="group__group__c__api__functions.html#ga9883b5677f3f49d229d8883f414e9806">cy_http_server_stop</a> API function. </p><div class="fragment"><div class="line"><span class="preprocessor">#define MAKE_IPV4_ADDRESS(a, b, c, d)     ((((uint32_t) d) &lt;&lt; 24) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) c) &lt;&lt; 16) | \</span></div>
<div class="line"><span class="preprocessor">                                          (((uint32_t) b) &lt;&lt; 8) |\</span></div>
<div class="line"><span class="preprocessor">                                          ((uint32_t) a))</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SERVER_IP_ADDRESS                 MAKE_IPV4_ADDRESS(192, 168, 18, 9)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define HTTP_PORT            80</span></div>
<div class="line"><span class="preprocessor">#define MAX_SOCKETS          2</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* HTML page sent in response to the client */</span></div>
<div class="line"><span class="preprocessor">#define CAPTIVE_PORTAL_REDIRECT_PAGE \</span></div>
<div class="line"><span class="preprocessor">&quot;&lt;html&gt;&lt;head&gt;&quot;</span> \</div>
<div class="line">&quot;Hello, This is a reference HTTP server application&quot; \</div>
<div class="line">&quot;&lt;/head&gt;&lt;/html&gt;&quot;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="group__http__server__struct.html#ga047ac1c7063077c58da4cc991ad3b1bf">cy_http_server_t</a>          httpSer_8;</div>
<div class="line">cy_network_interface_t    nw_interface_8;</div>
<div class="line">cy_socket_sockaddr_t      IP_address_8;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> snippet_http_server_stop(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Status variables for various operations */</span></div>
<div class="line">    cy_rslt_t TestRes = <a class="code hl_define" href="group__http__server__defines.html#gaf18faa0179a6087e4b03d9a81d02010e">CY_RSLT_ERROR</a>;</div>
<div class="line">    (void)TestRes;</div>
<div class="line">    <span class="comment">/* IP address of the server */</span></div>
<div class="line">    IP_address_8.ip_address.ip.v4 = SERVER_IP_ADDRESS;</div>
<div class="line">    IP_address_8.ip_address.version = CY_SOCKET_IP_VER_V4;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Add the IP_address information to the network interface object */</span></div>
<div class="line">    nw_interface_8.object  = (<span class="keywordtype">void</span> *) &amp;IP_address_8;</div>
<div class="line">    nw_interface_8.type = CY_NW_INF_TYPE_WIFI;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Initialize the network socket */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga74c8a85310d1537177f80adaef20cfd9">cy_http_server_network_init</a>();</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga1ca51f61222e3aed87c0a15955e2e269">cy_http_server_create</a>( &amp;nw_interface_8, HTTP_PORT, MAX_SOCKETS, NULL, &amp;httpSer_8 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Register a static resource with the HTTP server */</span></div>
<div class="line">    <a class="code hl_struct" href="structcy__resource__static__data__t.html">cy_resource_static_data_t</a> static_resource;</div>
<div class="line">    static_resource.<a class="code hl_variable" href="structcy__resource__static__data__t.html#a898a2959797f5d333f70915e27c8f8bf">data</a> = CAPTIVE_PORTAL_REDIRECT_PAGE;</div>
<div class="line">    static_resource.<a class="code hl_variable" href="structcy__resource__static__data__t.html#a288d94a277b56b226480d6d18e7787ce">length</a> = <span class="keyword">sizeof</span>( CAPTIVE_PORTAL_REDIRECT_PAGE );</div>
<div class="line">    <a class="code hl_function" href="group__group__c__api__functions.html#gad03c8e19c0792c4307356e52ba3006ee">cy_http_server_register_resource</a>( httpSer_8, (uint8_t*) <span class="stringliteral">&quot;/get&quot;</span>, (uint8_t*)<span class="stringliteral">&quot;text/html&quot;</span>, <a class="code hl_enumvalue" href="group__http__server__struct.html#gga32d601085911dbd59b7ecd50a6b7f584a16c98c125133981542d412c2449988a1">CY_STATIC_URL_CONTENT</a>, &amp;static_resource );</div>
<div class="line">    <span class="comment">/* Start HTTP server */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga3cb020a5e45f80b55ea3fc2eb1c6c3df">cy_http_server_start</a>( httpSer_8 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Stop the HTTP server */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga9883b5677f3f49d229d8883f414e9806">cy_http_server_stop</a>( httpSer_8 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Delete the HTTP server object */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga13251efe44c82d506b1ccf48e5acc5dd">cy_http_server_delete</a>( httpSer_8 );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Deinitialize the network socket */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga1922ac08bf92b285a8f96bb6170291af">cy_http_server_network_deinit</a>();</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* Failure path */</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__group__c__api__functions_html_ga13251efe44c82d506b1ccf48e5acc5dd"><div class="ttname"><a href="group__group__c__api__functions.html#ga13251efe44c82d506b1ccf48e5acc5dd">cy_http_server_delete</a></div><div class="ttdeci">cy_rslt_t cy_http_server_delete(cy_http_server_t server_handle)</div><div class="ttdoc">Deletes the given HTTP server instance and resources allocated for the instance by the cy_http_server...</div></div>
<div class="ttc" id="agroup__group__c__api__functions_html_ga1922ac08bf92b285a8f96bb6170291af"><div class="ttname"><a href="group__group__c__api__functions.html#ga1922ac08bf92b285a8f96bb6170291af">cy_http_server_network_deinit</a></div><div class="ttdeci">cy_rslt_t cy_http_server_network_deinit(void)</div><div class="ttdoc">One-time deinitialization function for Secure Sockets implementation.</div></div>
<div class="ttc" id="agroup__group__c__api__functions_html_ga9883b5677f3f49d229d8883f414e9806"><div class="ttname"><a href="group__group__c__api__functions.html#ga9883b5677f3f49d229d8883f414e9806">cy_http_server_stop</a></div><div class="ttdeci">cy_rslt_t cy_http_server_stop(cy_http_server_t server_handle)</div><div class="ttdoc">Stops a HTTP server daemon (web server) Before calling this API function, API cy_http_server_start mu...</div></div>
</div><!-- fragment --> <h2><a class="anchor" id="snip9"></a>
Code Snippet 9: HTTP URL query</h2>
<p >Search a key-value pair, fetch the value of a key, and get the number of queries from the given URL using URL-processing functions. </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> snippet_http_server_url_query(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* Status variables for various operations */</span></div>
<div class="line">    cy_rslt_t TestRes = <a class="code hl_define" href="group__http__server__defines.html#gaf18faa0179a6087e4b03d9a81d02010e">CY_RSLT_ERROR</a>;</div>
<div class="line">    (void)TestRes;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> url[] = <span class="stringliteral">&quot;https://example.com/?product=shirt&amp;color=blue&amp;newuser&amp;size=m\n&quot;</span>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> key[] = <span class="stringliteral">&quot;product\n&quot;</span>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> value[] = <span class="stringliteral">&quot;shirt\n&quot;</span>;</div>
<div class="line">    <span class="keywordtype">char</span> *value_found = NULL;</div>
<div class="line">    uint32_t value_length = 0;</div>
<div class="line">    uint32_t query_param_count = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* Check if the provided key-value pair is present in the given URL */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#gac1cd7f7af7f2f9aa6e288be4e2a6419f">cy_http_server_match_query_parameter</a>( url, key, value );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* URL query failed */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Retrieve the value and length for a given key from the URL */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#gaf2bee362096d822f39a4851c63c5abf3">cy_http_server_get_query_parameter_value</a>( url, key, &amp;value_found, &amp;value_length );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* URL query failed */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* Get the number of query parameters found in the URL query string. */</span></div>
<div class="line">    TestRes = <a class="code hl_function" href="group__group__c__api__functions.html#ga3825981f26c68c82d781f5fb7f2a4bfc">cy_http_server_get_query_parameter_count</a>( url, &amp;query_param_count );</div>
<div class="line">    <span class="keywordflow">if</span>( TestRes != CY_RSLT_SUCCESS )</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">/* URL query failed */</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__group__c__api__functions_html_ga3825981f26c68c82d781f5fb7f2a4bfc"><div class="ttname"><a href="group__group__c__api__functions.html#ga3825981f26c68c82d781f5fb7f2a4bfc">cy_http_server_get_query_parameter_count</a></div><div class="ttdeci">cy_rslt_t cy_http_server_get_query_parameter_count(const char *url_query, uint32_t *count)</div><div class="ttdoc">Returns the number of parameters found in the URL query string.</div></div>
<div class="ttc" id="agroup__group__c__api__functions_html_gac1cd7f7af7f2f9aa6e288be4e2a6419f"><div class="ttname"><a href="group__group__c__api__functions.html#gac1cd7f7af7f2f9aa6e288be4e2a6419f">cy_http_server_match_query_parameter</a></div><div class="ttdeci">cy_rslt_t cy_http_server_match_query_parameter(const char *url_query, const char *parameter_key, const char *parameter_value)</div><div class="ttdoc">Checks whether the given parameter key-value pair is present in the given URL query.</div></div>
<div class="ttc" id="agroup__group__c__api__functions_html_gaf2bee362096d822f39a4851c63c5abf3"><div class="ttname"><a href="group__group__c__api__functions.html#gaf2bee362096d822f39a4851c63c5abf3">cy_http_server_get_query_parameter_value</a></div><div class="ttdeci">cy_rslt_t cy_http_server_get_query_parameter_value(const char *url_query, const char *parameter_key, char **parameter_value, uint32_t *value_length)</div><div class="ttdoc">Searches for a parameter (key-value pair) in a URL query string and returns a pointer to the value.</div></div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>HTTP Server Middleware Library</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
</body>
</html>
